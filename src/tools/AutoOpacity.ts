import { interpValues } from './AutoOpacityData.js'

const lerp = (a: number, b: number, t: number): number => {
    return a + t * (b - a);
};

// Trilinear interpolation function
const trilinearInterpolation = (
    array: number[][][],
    x: number,
    y: number,
    z: number
): number => {
    const x0 = Math.floor(x);
    const x1 = Math.ceil(x);
    const y0 = Math.floor(y);
    const y1 = Math.ceil(y);
    const z0 = Math.floor(z);
    const z1 = Math.ceil(z);

    // Clamp indices to stay within array bounds
    const safeX0 = Math.max(0, Math.min(x0, array.length - 1));
    const safeX1 = Math.max(0, Math.min(x1, array.length - 1));
    const safeY0 = Math.max(0, Math.min(y0, array[0].length - 1));
    const safeY1 = Math.max(0, Math.min(y1, array[0].length - 1));
    const safeZ0 = Math.max(0, Math.min(z0, array[0][0].length - 1));
    const safeZ1 = Math.max(0, Math.min(z1, array[0][0].length - 1));

    // Get the 8 nearest points
    const c000 = array[safeX0][safeY0][safeZ0];
    const c001 = array[safeX0][safeY0][safeZ1];
    const c010 = array[safeX0][safeY1][safeZ0];
    const c011 = array[safeX0][safeY1][safeZ1];
    const c100 = array[safeX1][safeY0][safeZ0];
    const c101 = array[safeX1][safeY0][safeZ1];
    const c110 = array[safeX1][safeY1][safeZ0];
    const c111 = array[safeX1][safeY1][safeZ1];

    // Interpolate along x-axis
    const tx = x - x0;
    const c00 = lerp(c000, c100, tx);
    const c01 = lerp(c001, c101, tx);
    const c10 = lerp(c010, c110, tx);
    const c11 = lerp(c011, c111, tx);

    // Interpolate along y-axis
    const ty = y - y0;
    const c0 = lerp(c00, c10, ty);
    const c1 = lerp(c01, c11, ty);

    // Interpolate along z-axis
    const tz = z - z0;
    return lerp(c0, c1, tz);
};

// const interpValues = [[[0.1281327903402129,0.12198039955698314,0.29318071970066256,0.30000000809706007,0.6455445993357056,0.6998966567642106,0.22067184272846196,0.2200000000313345,0.2212529153825421,0.4799999999999993,0.48],[0.13515358994516796,0.04889920802998612,0.09561143776098426,0.29997100014483513,0.2803067796786092,0.2948450967572526,0.2200220473737187,0.22000000015318924,0.22025169815810253,0.4799999999967462,0.48],[0.0665389121007599,0.26401113039011614,0.2964682731273238,0.494534144816695,0.28000000861333907,0.2800001017364593,0.22502191148467338,0.24246578322254422,0.3999979936447311,0.4241528454491435,0.4799999999370664],[0.32545485195673396,0.31098567456256465,0.3336057424473559,0.49475344939719684,0.49744740155871225,0.07081740542469031,0.39986979416363877,0.39999999999953895,0.3999999999999419,0.3999999999418455,0.39999994172465825],[0.30038667321551665,0.36132238085927787,0.25960280072056935,0.4133657785198457,0.47796632110733633,0.07016680933088221,0.3996574057412927,0.39999999999400737,0.4,0.40000000000181196,0.4000000974996994],[0.29999843397997894,0.30001066744706967,0.10215369189280699,0.10626811148100274,0.23272253960000364,0.14873244750768655,0.4092585249600531,0.400000000441609,0.4000000000002337,0.4000000071388521,0.4003826525106519],[0.6927623229136012,0.33012262943616955,0.12979407394677742,0.10175667136646918,0.1330943116519876,0.4494894545053682,0.4499999993968576,0.40692190903160314,0.4000000002308884,0.4000000000002164,0.40000000000164954],[0.6411170503551965,0.633567611441849,0.324070882277634,0.3020216285912155,0.30115380989414003,0.35002543996827,0.355780893647739,0.40351121103272464,0.40000332139092504,0.40000000311576317,0.4000000000030387],[0.4875007640018034,0.36271763635791143,0.3039605865127745,0.4719484312388918,0.6375640553622235,0.3500003331911803,0.3500014414666231,0.8163190765981783,0.4433724098141278,0.4000727484281863,0.40348489739041865],[0.39193985250357355,0.31935818942032723,0.30008100145492766,0.40095274700466677,0.5827621052988012,0.6174289844179495,0.34242495010119745,0.5951862265577788,0.5491906048494707,0.4120358916517666,0.5222135481018056],[0.5961812385615008,0.33798758415820834,0.39852100553792125,0.40017168311815143,0.5352221585316114,0.6524798953340591,0.121834856891319,0.3405343850797353,0.428389288648939,0.7111325044584691,0.6115968188147788]],[[0.0931799615457582,0.05722551145588634,0.019820260789803257,0.299993649251247,0.5307069758391707,0.6078754903305297,0.24045562514194077,0.2203617929118088,0.33995610237719553,0.47999452924637975,0.4799999999999999],[0.04275690223439238,0.03309704027911322,0.06862198072982056,0.23916513178388105,0.2806101299883284,0.2953116644900078,0.24837172161742072,0.25348468199174856,0.33999915554978727,0.44467184535208754,0.4799999998538658],[0.03676641341469034,0.181569081813928,0.23061490145396554,0.13217193370688413,0.26217733132550736,0.3238492295224034,0.06393724131493683,0.3494838801367383,0.3161774329724265,0.3000004841487879,0.30543861865988625],[0.30426254962359073,0.30049174764212233,0.20873030048547184,0.11713594143492066,0.07092889848445773,0.0700037930449406,0.29183125062476745,0.39995193145308766,0.3999813780697774,0.383991261580156,0.30118742684979977],[0.3003497786493303,0.36984027626856386,0.20633164478630944,0.41133117547099046,0.19744214976156865,0.07767437776342798,0.30000066720017465,0.399776228574856,0.40000017175111824,0.40498547335307755,0.4999645928345837],[0.27638294041219774,0.3494967956052671,0.4142228450969734,0.4691509552265591,0.370015271105447,0.1078346839081517,0.30683399149169405,0.39312678092788184,0.402031026464869,0.49954164304557297,0.49999999346312746],[0.23059153809265953,0.3955330910645176,0.2997613119028987,0.20437556607331864,0.12191309365198226,0.3180020837056041,0.44999990968157566,0.4499997310984644,0.4003193977814157,0.40196398095179653,0.49323225006320326],[0.6020471206461282,0.6195690727594555,0.33154894963723547,0.43691999386645763,0.29975752417325807,0.3033363109218395,0.44815946749507707,0.3766296766552289,0.4022766077262613,0.40000214825841496,0.4000000588028935],[0.3804977551668571,0.37721576991029293,0.4070846256105487,0.47996552130527154,0.6329430006287134,0.6098441801211186,0.3074168324920221,0.7914931100844362,0.8147834929350167,0.43347877812966246,0.5958507825107346],[0.3645908235859556,0.41836598041556405,0.30159876569789823,0.6053019085553343,0.6299729472931347,0.7894233432540568,0.5430040404363288,1.0945707160496472,0.7896942368868495,0.5861274672047044,0.5378153104463771],[0.3075459223987288,0.5756646537547969,0.6346619752763675,0.44741597775851705,0.60365753458628,0.8994734358102567,0.5673068715722909,1.0627455686587053,0.4812351747040857,0.5784277481057105,0.5113461722542906]],[[0.012660361554886108,0.10363644102730273,0.09994701898604683,0.27784470336146505,0.38094083913513926,0.33787970868906836,0.3581045778857159,0.25182222443774993,0.3384245810895766,0.3399999112984055,0.4799998912710806],[0.010160978244569928,0.03552214271666912,0.12300299480525995,0.1916288029511052,0.3047163835721166,0.3564685818362257,0.08768059077285524,0.3267557640537589,0.3399899142114694,0.3108965470067573,0.3023181812245955],[0.04332294352095683,0.16268741289292507,0.15349792525025202,0.06681479883525357,0.31754964441396505,0.36741099708393105,0.3316603156892602,0.3499557553408557,0.3117688813207518,0.30000028809348883,0.3000000059701175],[0.17591920655101584,0.17864559992447762,0.17248086767143178,0.08066051393478002,0.21933650015425538,0.08089175230434931,0.4098358266004181,0.33283816755049794,0.3025591247126675,0.3001234227691671,0.3061712056974955],[0.1568286220454752,0.29103390968878495,0.06240124540892969,0.18577152676478204,0.08825159887698285,0.0756101291280836,0.29998458011269086,0.30147313509774376,0.5684892241157823,0.5000230962328248,0.5000000029230579],[0.060931670926363216,0.5090032473898601,0.4374015617592125,0.29791240908022326,0.18125210531292282,0.07893696370053531,0.2993518885571352,0.3291497823369368,0.5925553532461677,0.5001318516487272,0.5000000140191627],[0.06952693041747693,0.38457383342157053,0.28357401974431756,0.1954833147739458,0.13049828370215513,0.1059029484864067,0.4491859376145696,0.4489975832580185,0.5376486668711166,0.5007485210136913,0.5000000801054254],[0.6975485333918606,0.7852443493512093,0.636475256639941,0.3071314428692544,0.2955805994577952,0.35250965218143426,0.3222578481880788,0.27120239534080454,0.32501160352759073,0.3743727172772981,0.5921530072169447],[0.37592046270793694,0.4642495183766277,0.44098171841267236,0.39739173719661003,0.2491321938781105,0.604711238155164,0.24881442563538977,0.2725894998634023,0.46879704221373014,0.6280341974287155,0.5999803205094969],[0.30155658782601197,0.3311900604478993,0.4292631636025617,0.28891020241292,0.3202404831894005,0.7455235016599051,0.19853867449703347,0.18037567297406798,0.6487910857713055,0.6096663891399302,0.5998599128311566],[0.30129424240408453,0.5797013700501507,0.5972621757679906,0.3173560814704221,0.6488057394747164,0.7139734718505837,0.5862797734166164,0.39378099851629017,0.6486691231140068,0.5943749322023424,0.59297390841732]],[[0.012110681516160012,0.2891966448592719,0.10080454889618147,0.3578787086182016,0.31284868304479785,0.13398887394860368,0.4848945259905866,0.27094291010421523,0.2649066092331787,0.3398839237833274,0.3499709077693421],[0.010002868225260628,0.018989063287384367,0.016316548371767787,0.29019058136165876,0.12491054206933445,0.4447842813720209,0.28109800063221496,0.2848286051419524,0.33981459324075786,0.3016271571996093,0.30032106363386407],[0.010971560104755744,0.10026075991101961,0.07418495134244418,0.08843611482120542,0.2366424563851089,0.458006288525298,0.4298121456446728,0.3335871111319118,0.30829744840056444,0.3000153826504062,0.6969263523474805],[0.16761083287076672,0.21159652429031645,0.2749776067971236,0.11920419540636024,0.11570565924532542,0.4374962010493831,0.1826462295952563,0.16033931455978195,0.301749910752464,0.48857928532105915,0.7199987590909106],[0.20137994135949544,0.3494315446397327,0.3508910886928276,0.3666713516071211,0.09012062679804014,0.030029174668911657,0.24306173609206447,0.3053535634911777,0.5925525042097817,0.5001396620433313,0.5552071661407729],[0.2070664629904975,0.27387523533741465,0.4089242768892539,0.3660480251510224,0.3112431417558572,0.05182307156408371,0.2781591532565895,0.36176277789029737,0.5986116677700304,0.5007487465636122,0.5000000976544268],[0.22204332731712167,0.25601267349259,0.299816120835383,0.2989094247286071,0.362543938314825,0.20347788644789305,0.29203208084242593,0.35000055747369685,0.3507111249150812,0.5027875488262625,0.5000004576320293],[0.23501043172018252,0.5840740285325201,0.4826189579562872,0.13332878440488966,0.3430244717392024,0.3731292665639018,0.1918453322188662,0.3499883219905607,0.34999999999215464,0.35000000226748507,0.3701037388021298],[0.4500718628597719,0.3555515731547558,0.5601428502234437,0.1322154003217004,0.1803293148956719,0.19539636700919016,0.22188848797845545,0.3842861175855525,0.35829745913165245,0.46911937564338585,0.47496304090265007],[0.30513814652880455,0.5591579888930213,0.5375300416807194,0.24456579947272067,0.6080483289044907,0.6397157205422297,0.1544883676518387,0.39384156285842,0.42157497615034445,0.3878041673204716,0.5028923561889613],[0.6255062387875434,0.3609225495684444,0.3612087325790853,0.38603894634989583,0.6642296296107405,0.647651348657215,0.4014255243940399,0.3273789513142117,0.5392183246338373,0.3660205917640193,0.5416412200018701]],[[0.42131194930508353,0.22564818473719744,0.13862012776629537,0.32905547714146666,0.12794190708734554,0.4650740272498858,0.380014874934689,0.3002118897638844,0.3959530697702883,0.4199999999262701,0.41999996004417495],[0.30774571792912697,0.34316853415047316,0.4823946688024695,0.3540269133292453,0.11957728000581423,0.4598049440314616,0.32508405108368044,0.29741578239714156,0.41999089999445804,0.42000000756466516,0.2523633107536474],[0.2693870334674637,0.20937573039916516,0.7696076410013435,0.6642540619015636,0.04915292403616859,0.45016206462009084,0.26931149358724066,0.16032978460013736,0.25065804461394653,0.7198727557989328,0.7182216492966944],[0.20591567075060638,0.20007657625089248,0.2840090377467019,0.08440654431427069,0.205130046177894,0.29658278270651334,0.13766765191966368,0.042752594544691665,0.21743569947045113,0.7199997493158273,0.7199999207681264],[0.26700331573891023,0.20289865299717275,0.27042240244325827,0.20105186499303146,0.27048668687319627,0.16868314244519536,0.040022589487752294,0.04006631631523055,0.1935796194783391,0.7198193807951069,0.7199999952069238],[0.22203605941748106,0.7199796582712595,0.71956721699038,0.14298476525304324,0.09138015251107143,0.14995431261987624,0.28185343038007865,0.08065843420724167,0.5742647854552532,0.5041481096289802,0.701571401402228],[0.21894391924523726,0.7197241274618449,0.7199505129687509,0.13511330313935932,0.12267189245655366,0.2956825773235215,0.2996410851838347,0.34436404528758147,0.34999843659875013,0.3537006992544367,0.3700944196766576],[0.23281994914238488,0.7099451809065792,0.5015407309269632,0.29870053885757425,0.2991253553618164,0.1652898520711298,0.19543009395211303,0.36075264398013096,0.3500313454493609,0.35859954382682796,0.370000000602864],[0.45828345802427184,0.5000047064133767,0.5000622033171594,0.19743518493178122,0.18211735343375643,0.15591796825650187,0.3635829962813282,0.39376565279174286,0.3523337443512453,0.4685655300924232,0.9305748353019537],[0.7547080328877032,0.7780474188884409,0.4425996131969344,0.7352435982834401,0.7914560007376502,0.43642434089511845,0.3232762891633508,0.3669283417331113,0.32417849985135294,0.3219799374217385,1.1475830604275996],[0.7999795137831881,0.7956797892094166,0.36001177441418997,0.7740324940689088,0.7991490197533663,0.32196518445500116,0.3199978542820534,0.28639099217900366,0.3490805740217744,0.30277854637654533,0.6586722607874349]],[[0.4249764747961375,0.3987976122788898,0.23218102179914107,0.07947901598408813,0.28674187439420157,0.21228243555730325,0.2727200884606401,0.3316536819951247,0.4199999991806091,0.419999999999916,0.4199951787549067],[0.4249556118821838,1.014175651844404,0.49897949642470063,0.22129311385870407,0.28673695330549553,0.23909839567878316,0.2907172136065871,0.16007186385540828,0.4199923298410965,0.419999150976078,0.12184797301648748],[0.3000691984989567,1.0644100265582628,0.46113297347559656,0.404412260385447,0.03699608294224792,0.33069965792933026,0.1670934358050229,0.16037792697507908,0.25007114180910694,0.17533692086788805,0.12003108234381321],[0.2999047842388267,0.22003870989336335,0.36168157475654084,0.3649284768784235,0.10763968839142254,0.13159966005326698,0.04063222857879437,0.10883528057283384,0.245364126779061,0.6635924869440226,0.44302269352084855],[0.22658824202798888,0.22000621948131693,0.2638249700884861,0.29853922493018176,0.2364659572504683,0.20833994357299762,0.06931136142595401,0.14263721057265333,0.20022389734608997,0.30825376103686364,0.7199770917930793],[0.7199278459489331,0.7199895615598433,0.5524141586001649,0.2245503818264783,0.14950581740922897,0.15873923510239224,0.18762765421699756,0.5762620727233305,0.5809924778832766,0.1854829553817815,0.6656400011149516],[0.7191337556333547,0.7199525749865314,0.35739318893442,0.21254806725959682,0.1940125883433037,0.17712713807500824,0.21442067560439101,0.09110406842975094,0.23773625690379518,0.39660999357024,0.38887276702968926],[0.701369164987082,0.6284663818605445,0.4754892185548143,0.36121760174732104,0.27113043070836257,0.1427526421991784,0.05521379846761335,0.06405292582165276,0.47672964758661657,0.3699983882087454,0.37000002868481463],[0.45800057337834715,0.49999366507480003,0.4999993062766198,0.4909180001632245,0.2445885799870545,0.19186375833007613,0.2889469360140318,0.3133150139373552,0.35126876837848353,0.36609737413944576,0.37002077696831914],[0.4593539894578143,0.7073835401145065,0.49589479870404674,0.46972708731676044,0.43177002432548356,0.17308983257001959,0.41274694982357074,0.4189908251478246,0.34055325593376573,0.585641310309306,0.695265599840197],[0.7692679713874765,0.799951028055387,0.5010078200888807,0.4929287226810359,0.3218937548373923,0.24007160055259869,0.3285124800304731,0.5205659849989435,0.3203234920912813,0.5554868927521338,0.5737477458373417]],[[0.3659791587812946,0.11989851025391976,0.18664536340045165,0.2734723962650827,0.20469653275849337,0.3506212180511632,0.3876038855819951,0.39389650188767056,0.41999999811616795,0.41999999998985815,0.41941935517802925],[0.53712208406393,1.047839712323493,0.38935911165317943,0.4263571896085372,0.14369422824798186,0.4486785759174649,0.4338329401169559,0.1294241178097106,0.41995596287681825,0.4198981895772156,0.1200154088678822],[0.3000078317469013,0.9465649361372559,0.4043194236202558,0.2840227091927482,0.2755410533689276,0.4480701483276328,0.06635648132908292,0.0695009029859911,0.2499985461435356,0.12346237275386858,0.12000000001022883],[0.29998921095808356,0.22009903205868073,0.31902826161814174,0.33469434669665477,0.2541159299411561,0.2785875918580496,0.013223469825017802,0.23476756110500777,0.307997296482771,0.4181530591191326,0.12000678341989718],[0.25523820298727723,0.22000774070212978,0.2644694984054876,0.20661188208725498,0.28111093769492335,0.2260627900985741,0.06039699024000963,0.5742377512232951,0.18182591613402033,0.17832913816427987,0.32431286227681067],[0.7193157481075952,0.5854464265475893,0.5422645613769911,0.3476417705071244,0.4546174441604237,0.1550828665090438,0.32302386697223207,0.5988202522659298,0.3922986561946906,0.13170737545285147,0.5437569731291805],[0.7163361372856532,0.35032974858821675,0.35080946144795844,0.3429687756782472,0.34499385579493996,0.4050663852020868,0.40663603732643616,0.2424472365200739,0.5484628000620762,0.5499237852805866,0.5499921794863536],[0.4591040256087261,0.35005634654471385,0.3500024794051106,0.34984280366242654,0.8490679017155311,0.7743527786332094,0.24408721805716255,0.34084843266574727,0.3127623278864478,0.3620335337102781,0.3755294572487223],[0.4580000003264174,0.471065299577881,0.42929530914923747,0.41000263358960576,0.8376969136563583,0.8071705682192386,0.36469162869527416,0.5509332323549043,0.6306192897248465,0.3646982860265669,0.3699993921250331],[0.4580008247852246,0.45856767399738196,0.40998172242667935,0.4100018176924521,0.30518071738930264,0.5216392945560027,0.20667322539248884,0.26361571771097086,0.36295563698343153,0.30279852553062114,0.3211198313883201],[0.4600888748606996,0.7346692821108818,0.30267287792725445,0.39713022073151494,0.24012596466401528,0.30886938785821627,0.5540605871954631,0.2662261178363955,0.2415950582500808,0.4604601801146747,0.4835421436230737]],[[0.29999999955098144,0.29909676659603995,0.35198976067902804,0.4064067072382503,0.4414166304878984,0.3879345741950878,0.6229661017730692,0.5740663847190068,0.2837651270909162,0.4123954027857066,0.34080510965243],[0.3000000539788886,0.2996137263506437,0.4828332050300672,0.4987592865288156,0.39695920822031733,0.27447007302714654,0.4896097008181143,0.649424893064972,0.11400349334720802,0.36734181407943167,0.12000012974238423],[0.3000008864051787,0.5705427430305352,0.39596855762706523,0.33699291730211106,0.30807213132360617,0.09420910657640034,0.012105946566983179,0.01657476895926288,0.29973632778891046,0.4115386149436876,0.12008512659887002],[0.2999987776323004,0.26308263926808334,0.4974876650235365,0.3546461729932887,0.28004611178493727,0.24191034919206172,0.1355437381435195,0.08987945885204375,0.41992589073876574,0.41998001857372586,0.5499154256940058],[0.28067166590054154,0.2803798825829056,0.4429453128248622,0.4995251374191695,0.44292238571424103,0.11330580916271095,0.058944581128756106,0.12126479534533101,0.34880769052493665,0.27947119222272865,0.5497855123404131],[0.28000195468218186,0.2804865786213349,0.2616034369232079,0.31214751536394236,0.4019194143937314,0.4394171495080894,0.0538202178429196,0.09010545796262531,0.4982566274265217,0.48422470697163855,0.5221458233625124],[0.3500123455157604,0.3499511320606452,0.15800566087816129,0.10377709883165229,0.31152656295028336,0.5545980928403857,0.18459653487766334,0.1828651953528568,0.5489861437324823,0.4832116921408804,0.5491214311996815],[0.45216186672675107,0.3499988288755111,0.34304796135399296,0.10145836195271801,0.521663399121383,0.43335851339333464,0.20656589398572706,0.27295903003075134,0.25908501322178196,0.30129793450247594,0.5377451754616772],[0.4580000000001963,0.45762830512811176,0.4097875667377831,0.34093678580249326,0.39959999995140744,0.848404539938813,0.12680025629271932,0.3294085576654363,0.6202187885996242,0.343290992694048,0.22056126946772517],[0.45800000049899986,0.3267830661310998,0.3003072922774568,0.3110666654992941,0.3100100148270086,0.9344991672277739,0.3064580847426198,0.20714704388609478,0.18158775470287614,0.22436948285788522,0.595132943504626],[0.4580012695458806,0.30000825156254096,0.3000000015718036,0.3000624114904806,0.3647204085824753,1.1921554954234388,0.5773121034441833,0.49005386059114214,0.20823092145039074,0.35359237154112644,0.6010830222479606]],[[0.3000000012227332,0.3000001147292275,0.35000562840360594,0.322349244022408,0.15612007593035557,0.5180785764250125,0.5207132670609707,0.44188350722278297,0.11549879021105239,0.22999925038199248,0.22999872963436416],[0.30000000013840633,0.30000003322022734,0.3844938332364261,0.4994688326136091,0.13124767973386706,0.22602674744175555,0.48595298617641947,0.298604180970932,0.050703364359604076,0.2299621453771559,0.22976845748513453],[0.3000000000144241,0.2999360814204899,0.49630821719735496,0.49222266215446875,0.4168654447405241,0.3994962647973754,0.3535761098949778,0.3598527516745185,0.26360433453846865,0.21084570816547896,0.5498804798240612],[0.28000678997684336,0.2800075628634868,0.29179656974585133,0.4950399883228585,0.295025992639506,0.37290431282145287,0.2678263289670366,0.3544618043076849,0.28494396458942156,0.3556257869220372,0.5495006138533538],[0.2800000001405436,0.2800002303486065,0.2803111947567142,0.23297237839273124,0.22068286807008838,0.17964519743475094,0.08975651521818483,0.16501901016148224,0.47013672646375665,0.7647173102107487,0.44100667478083716],[0.27999999999357245,0.2799994295366829,0.2595274231979767,0.22002653955441243,0.2652398032512679,0.5745024200467371,0.06352409352026336,0.21107963304333074,0.4674199317946484,0.8117316810110704,0.10833322181079387],[0.28000006235464225,0.2781325839214493,0.10960417668646742,0.23809217609784813,0.3071182092015666,0.552694092567651,0.19809166274505538,0.11731747126479339,0.470765382835925,0.30080649392522385,0.30683163501493277],[0.39888714159005784,0.20229385501093838,0.10107782662798268,0.2448445280579339,0.47761099345174063,0.22623750557730551,0.19979879315241958,0.12317284101538624,0.3716159694514726,0.2990480462801513,0.29443339520230966],[0.45799997913560864,0.3000024028316464,0.3024245983668653,0.3099999676613012,0.3099854023467956,0.10017501757348755,0.10004703508237191,0.2480571390867473,0.3794231287463723,0.4737654092315651,0.22023022891781618],[0.45791784269380986,0.3000000005633006,0.30000051821110785,0.30992944158055924,0.3100228823218405,1.041731724145006,0.34505618477794076,0.4050706137249588,0.4430198171019063,0.38912463121709673,0.5910609432296191],[0.3518090974859391,0.30000000000014265,0.3000000000850522,0.30022581731961206,0.43050897727446197,1.1998763713466485,0.6036305841868783,0.5154904920731581,0.8428964516840629,0.241801541851852,0.7205853834376762]],[[0.41499649622485935,0.4145787332675688,0.20000004661445628,0.20002213482791664,0.2199147974346043,0.7969608542925236,0.6783934983225048,0.3579663606014861,0.2299683303554674,0.22999999318727132,0.2245526539639806],[0.41496905375799076,0.41138227553896134,0.20000002794479999,0.20000669970864104,0.2794032521009389,0.28072402905181676,0.3152768221412864,0.06025353456520658,0.2287076962011835,0.22999872951281514,0.2200445982326518],[0.4147271847470768,0.3802455807183671,0.21695261682263078,0.2608576891841671,0.22108230702991005,0.22204914101207393,0.30068411005595097,0.36014569153227044,0.3221687648927471,0.2225317264671704,0.2200002436040061],[0.2800000001699944,0.28000000436222455,0.27999536837440403,0.22627395655674687,0.16069045541764038,0.27634064847622114,0.13989881333932117,0.29116809097626845,0.3136672915898878,0.3483915348829374,0.3556795873596846],[0.27999999999820696,0.2799998990697514,0.2750134505262444,0.2200123998185857,0.22005059915140432,0.18988155312859256,0.12856620142231345,0.1101989084043407,0.5172833518430221,0.7194104854764346,0.1058314282558572],[0.2799999991623949,0.2799549607440203,0.22144844284040463,0.22044171716345748,0.24992905821433675,0.39762743167696346,0.16520019665307045,0.19019352995372163,0.33554916754123465,0.8512313993062212,0.1055764930564126],[0.2799996264668942,0.2649434471165498,0.22350079540514456,0.24998745158854896,0.24978078642519758,0.49110218648157733,0.2000111907812259,0.24902778091140823,0.34960651021911354,0.17808812989005937,0.12007974475228378],[0.2798282502034119,0.23219316415845026,0.2093941026217533,0.10213531355817299,0.10001199308453469,0.11326836224484375,0.19996746962920775,0.2580670030376322,0.37160476709807927,0.13934018119965136,0.1414623433516587],[0.3184255114208049,0.299999957075664,0.1015441056892767,0.1000019208107623,0.10000000435664765,0.10062947148750284,0.10018547137370268,0.4214518488173829,0.4472733477818904,0.4819943313633467,0.5626209148079501],[0.30000529407076004,0.30000000000070487,0.3000019142748018,0.3099802300797079,0.30979560777111137,0.10069135671428267,0.3238779838550758,0.3960433546577738,0.3605526400526462,0.485324765838227,0.39034018737954845],[0.3000000013438104,0.30000000000000016,0.30000000031433016,0.30078668920467394,0.5524267032281776,1.1999825255117642,0.4188107472048004,0.3526322492052283,0.4236191707607762,0.6003716094098418,0.6997508165775085]],[[0.415,0.41499999999398374,0.20005650118961288,0.23606765083392556,0.29983506442865787,0.27002677132328134,0.24989246431388032,0.0601890354634425,0.19951112803688967,0.2299362728925802,0.22000088736991874],[0.4149999999999999,0.4149999999777644,0.20001529414850194,0.21324888446981052,0.2997065318515546,0.2994042589083872,0.19655808923577076,0.06000027576844356,0.11800727016484013,0.22455265328174653,0.22000000475688025],[0.41499999999999987,0.41499999991719855,0.20000415899668691,0.21932455431036546,0.17863565678908624,0.16379452757313528,0.15660456311114987,0.06900775600829437,0.21388582500803063,0.22004461135858003,0.22000000002550335],[0.41085733967651383,0.2799999837871357,0.27906303088137174,0.16066197011279051,0.16002060819909059,0.16012497965336125,0.1692975301462705,0.16394342037154083,0.508641260063804,0.6240736665473656,0.5987215518600333],[0.27999999985341134,0.2799921128517232,0.22743069858784867,0.22000016592891375,0.21202056472574285,0.18803618658311455,0.1685523738145804,0.4828027034910964,0.5087980771070137,0.6240742241741261,0.6299079373542914],[0.27999993462813455,0.27667704825990336,0.2200190851891227,0.22157000296739152,0.2496783915906516,0.21013140981079156,0.11025048793521443,0.49815715700663316,0.5087877670631888,0.6240729257509546,0.6293119048635206],[0.27997086122139964,0.2222108348815497,0.22036204219125524,0.10327614748171171,0.10001794954182978,0.10000014005448651,0.19225627376621032,0.34460435280072554,0.34451042644002366,0.12847349444872247,0.12107387479228424],[0.26914672853143645,0.10003289936608259,0.10000014877128108,0.10000000079743471,0.10000000000427497,0.1000000036347266,0.157418668182011,0.345283639012549,0.33122581846808674,0.16958335330188667,0.5498477497042309],[0.2998797567115361,0.10000027445045372,0.10000000000003667,0.1000000000000002,0.1,0.10000000041142355,0.10093637040291746,0.48814100517179143,0.6872863152498977,0.7521261199512156,0.5500315885743964],[0.3000000000000923,0.2999999993976244,0.14290395179575868,0.10000009097901955,0.10000000020406542,0.10000056353592908,0.33858399288668534,0.34999007366364276,0.5939239284945326,0.6913780657883889,0.5209757859246137],[0.3,0.3000000000000004,0.3000000011616896,0.30239595643269634,0.721768159921971,0.4615850777649305,0.35000053898833244,0.35000000033861545,0.350001150977155,0.5138763459741811,0.9606666495154799]]]

export function getOpacity(r: number, g: number, b: number): number {
    // Map r, g, b values to array indices
    const x = r * (interpValues.length - 1);
    const y = g * (interpValues[0].length - 1);
    const z = b * (interpValues[0][0].length - 1);

    // Perform trilinear interpolation
    const interpolated = trilinearInterpolation(interpValues, x, y, z);

    return Math.round(interpolated * 100) / 100.0;
}